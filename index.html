<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <!-- æ‰‹æ©Ÿ/iPad ä¸ç¸®å° -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‹±æ–‡ç™¼éŸ³ç·´ç¿’</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 20px;
      margin: 0;
      padding: 16px;
      background: #f5f7fa;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .unit-btn {
      display: block;
      width: 100%;
      font-size: 24px;
      padding: 18px;
      margin-bottom: 16px;
      border-radius: 16px;
      border: none;
      background: #4f8cff;
      color: white;
    }

    .card {
      background: white;
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 20px;
      text-align: center;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }

    .word {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .zh {
      font-size: 22px;
      color: #666;
      margin-bottom: 16px;
    }

    button {
      font-size: 22px;
      padding: 16px 22px;
      margin: 8px;
      border-radius: 14px;
      border: none;
    }

    .listen {
      background: #ffd54f;
    }

    .record {
      background: #ff6b6b;
      color: white;
    }

    .back {
      background: #ccc;
    }

    .result {
      font-size: 22px;
      margin-top: 12px;
    }
  </style>
</head>

<body>

<h1 id="title">ğŸ“š é¸æ“‡å–®å…ƒ</h1>
<div id="content"></div>

<script>
/* ===== å–®å­—è³‡æ–™ ===== */
const units = {
  1: {
    title: "è¡£æœï¼ˆä¸€ï¼‰",
    words: [
      { en: "sweater", zh: "æ¯›è¡£" },
      { en: "t-shirt", zh: "æ±—è¡«" },
      { en: "shirt", zh: "è¥¯è¡«" },
      { en: "dress", zh: "æ´‹è£" },
      { en: "jacket", zh: "å¤–å¥—" }
    ]
  },
  2: {
    title: "è¡£æœï¼ˆäºŒï¼‰",
    words: [
      { en: "jeans", zh: "ç‰›ä»”è¤²" },
      { en: "shorts", zh: "çŸ­è¤²" },
      { en: "pants", zh: "é•·è¤²" },
      { en: "shoes", zh: "é‹å­" },
      { en: "glasses", zh: "çœ¼é¡" }
    ]
  }
};

const content = document.getElementById("content");
const title = document.getElementById("title");

let currentWords = [];
let currentIndex = 0;

/* ===== ä¸»ç•«é¢ ===== */
function showUnits() {
  title.textContent = "ğŸ“š é¸æ“‡å–®å…ƒ";
  content.innerHTML = "";

  for (const id in units) {
    const btn = document.createElement("button");
    btn.className = "unit-btn";
    btn.textContent = units[id].title;
    btn.onclick = () => startUnit(id);
    content.appendChild(btn);
  }
}

/* ===== å–®å…ƒé–‹å§‹ ===== */
function startUnit(id) {
  currentWords = units[id].words;
  currentIndex = 0;
  title.textContent = units[id].title;
  showWord();
}

/* ===== é¡¯ç¤ºå–®å­—å¡ ===== */
function showWord() {
  if (currentIndex >= currentWords.length) {
    content.innerHTML = `
      <div class="card">
        <h2>ğŸ‰ å…¨éƒ¨å®Œæˆï¼</h2>
        <button class="back" onclick="showUnits()">å›å–®å…ƒé¸å–®</button>
      </div>`;
    return;
  }

  const w = currentWords[currentIndex];

  content.innerHTML = `
    <div class="card">
      <div class="word">${w.en}</div>
      <div class="zh">${w.zh}</div>

      <button class="listen" onclick="speak('${w.en}')">ğŸ”Š è½ç™¼éŸ³</button>
      <br>
      <button class="record" onclick="record('${w.en}')">ğŸ¤ æˆ‘ä¾†èªª</button>

      <div class="result" id="result"></div>
    </div>`;
}

/* ===== TTS ===== */
function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  speechSynthesis.speak(u);
}

/* ===== éŒ„éŸ³ï¼‹åˆ¤æ–· ===== */
function record(answer) {
  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

  const resultEl = document.getElementById("result");

  if (!SpeechRecognition) {
    resultEl.textContent = "âŒ é€™å€‹ç€è¦½å™¨ä¸èƒ½éŒ„éŸ³";
    return;
  }

  const rec = new SpeechRecognition();
  rec.lang = "en-US";
  rec.interimResults = false;
  rec.maxAlternatives = 1;

  resultEl.textContent = "ğŸ§ æ­£åœ¨è½ä½ èªªè©±â€¦";
  rec.start();

  rec.onresult = (e) => {
    const spoken = e.results[0][0].transcript.toLowerCase();
    const target = answer.toLowerCase();

    if (spoken.includes(target)) {
      resultEl.textContent = "âœ… å¾ˆæ£’ï¼";
      currentIndex++;
      setTimeout(showWord, 1000);
    } else {
      resultEl.textContent = `âŒ æˆ‘è½åˆ°çš„æ˜¯ã€Œ${spoken}ã€`;
    }
  };

  rec.onerror = () => {
    resultEl.textContent = "âŒ æ²’è½æ¸…æ¥šï¼Œå†è©¦ä¸€æ¬¡";
  };
}

/* ===== å•Ÿå‹• ===== */
showUnits();
</script>

</body>
</html>
