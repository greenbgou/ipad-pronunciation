<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>è‹±æ–‡ç™¼éŸ³ç·´ç¿’</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f5f7fb;
  margin: 0;
  padding: 20px;
  text-align: center;
}

h1 {
  font-size: 28px;
}

button {
  font-size: 20px;
  padding: 14px 20px;
  margin: 8px;
  border-radius: 14px;
  border: none;
  cursor: pointer;
}

.unit-btn {
  width: 90%;
  background: #5b8cff;
  color: white;
}

.card {
  background: white;
  border-radius: 20px;
  padding: 30px;
  max-width: 420px;
  margin: 20px auto;
  box-shadow: 0 8px 20px rgba(0,0,0,.08);
}

.word {
  font-size: 36px;
  font-weight: bold;
}

.zh {
  font-size: 24px;
  margin-top: 10px;
}

.progress {
  margin-top: 10px;
  font-size: 18px;
  color: #555;
}

.feedback {
  font-size: 22px;
  margin-top: 15px;
}

.star {
  font-size: 28px;
}

.back-btn {
  background: #eee;
  font-size: 18px;
}
</style>
</head>

<body>

<h1>ğŸ“š é¸æ“‡å–®å…ƒ</h1>
<div id="unitMenu"></div>
<div id="app"></div>

<audio id="cheer" src="https://actions.google.com/sounds/v1/crowds/applause.ogg"></audio>

<script>
/* ===== å–®å­—è³‡æ–™ ===== */
const data = [
  { unit: 1, title: "è¡£æœï¼ˆä¸€ï¼‰", en: "sweater", zh: "æ¯›è¡£" },
  { unit: 1, title: "è¡£æœï¼ˆä¸€ï¼‰", en: "t-shirt", zh: "æ±—è¡«" },
  { unit: 1, title: "è¡£æœï¼ˆä¸€ï¼‰", en: "shirt", zh: "è¥¯è¡«" },
  { unit: 1, title: "è¡£æœï¼ˆä¸€ï¼‰", en: "dress", zh: "æ´‹è£" },
  { unit: 1, title: "è¡£æœï¼ˆä¸€ï¼‰", en: "jacket", zh: "å¤–å¥—" },

  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "scissors", zh: "å‰ªåˆ€" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "jeans", zh: "ç‰›ä»”è¤²" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "glasses", zh: "çœ¼é¡" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "shorts", zh: "çŸ­è¤²" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "pants", zh: "é•·è¤²ï¼ˆç¾å¼ï¼‰" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "shoes", zh: "é‹å­" },
  { unit: 2, title: "è¡£æœï¼ˆäºŒï¼‰", en: "trousers", zh: "é•·è¤²ï¼ˆè‹±å¼ï¼‰" }
];

let words = [];
let index = 0;

/* ===== å»ºç«‹é¸å–® ===== */
function showMenu() {
  document.getElementById("app").innerHTML = "";
  const menu = document.getElementById("unitMenu");
  menu.innerHTML = "";

  const units = [...new Map(data.map(d => [d.unit, d.title]))];
  units.forEach(([u, title]) => {
    const btn = document.createElement("button");
    btn.className = "unit-btn";
    btn.textContent = title;
    btn.onclick = () => startUnit(u);
    menu.appendChild(btn);
  });
}

/* ===== é–‹å§‹å–®å…ƒ ===== */
function startUnit(unit) {
  words = data.filter(d => d.unit === unit);
  index = 0;
  document.getElementById("unitMenu").innerHTML = "";
  showCard();
}

/* ===== é¡¯ç¤ºå¡ç‰‡ ===== */
function showCard() {
  if (index >= words.length) {
    document.getElementById("app").innerHTML = `
      <h2>ğŸ‰ å…¨éƒ¨å®Œæˆï¼</h2>
      <div class="star">â­â­â­â­â­</div>
      <button class="back-btn" onclick="showMenu()">ğŸ”™ å›åˆ°é¸å–®</button>
    `;
    document.getElementById("cheer").play();
    return;
  }

  const w = words[index];
  document.getElementById("app").innerHTML = `
    <div class="card">
      <div class="progress">ç¬¬ ${index + 1} é¡Œ / å…± ${words.length} é¡Œ</div>

      <div class="word">${w.en}</div>
      <div class="zh">${w.zh}</div>

      <button onclick="speak('${w.en}')">ğŸ”Š è½ç™¼éŸ³</button>
      <button onclick="startRecord()">ğŸ¤ æˆ‘ä¾†å¿µ</button>

      <div id="result" class="feedback"></div>

      <button onclick="next()">ä¸‹ä¸€å€‹</button><br/>
      <button class="back-btn" onclick="showMenu()">ğŸ”™ å›åˆ°é¸å–®</button>
    </div>
  `;
}

/* ===== ç™¼éŸ³ ===== */
function speak(text) {
  speechSynthesis.cancel();
  speechSynthesis.speak(new SpeechSynthesisUtterance(text));
}

/* ===== éŒ„éŸ³ ===== */
function startRecord() {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    alert("æ­¤è£ç½®ä¸æ”¯æ´èªéŸ³è¾¨è­˜");
    return;
  }

  const rec = new SpeechRecognition();
  rec.lang = "en-US";
  rec.start();

  rec.onresult = e => {
    const said = e.results[0][0].transcript.toLowerCase();
    const answer = words[index].en.toLowerCase();
    const stars = said.includes(answer) ? "â­â­â­" : "â­";

    document.getElementById("result").innerHTML =
      `<div>${stars}</div><div>ğŸ—£ï¸ æˆ‘è½èµ·ä¾†åƒï¼š${said}</div>`;
  };
}

/* ===== ä¸‹ä¸€é¡Œ ===== */
function next() {
  index++;
  showCard();
}

/* åˆå§‹ */
showMenu();
</script>

</body>
</html>
